<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VAT Margin Tracker - Pipedrive ‚Üî wFirma</title>
    <meta name="robots" content="noindex, nofollow, noarchive, nosnippet">
    <meta name="googlebot" content="noindex, nofollow, noarchive, nosnippet">
    <link rel="stylesheet" href="/style.css">
</head>
<body>
    <div class="container">
        <nav class="main-nav">
            <a href="/vat-margin.html" class="nav-link active">–û—Ç—á–µ—Ç—ã</a>
            <a href="/pnl-report.html" class="nav-link">PNL –û—Ç—á–µ—Ç</a>
            <a href="/analytics/mql-report.html" class="nav-link">Marketing</a>
            <a href="/" class="nav-link">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</a>
        </nav>
        <div class="tab-container">
            <div class="tab-header">
                <button class="tab-button active" data-tab="report2">–û—Ç—á—ë—Ç –ø–æ –º–µ—Å—è—Ü–∞–º</button>
                <button class="tab-button" data-tab="products">–ü—Ä–æ–¥—É–∫—Ç—ã</button>
                <button class="tab-button" data-tab="payments">–ü–ª–∞—Ç–µ–∂–∏</button>
                <button class="tab-button" data-tab="stripe">–ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è</button>
                <button class="tab-button" data-tab="deleted">–£–¥–∞–ª—ë–Ω–Ω—ã–µ –ø—Ä–æ—Ñ–æ—Ä–º—ã</button>
                <button class="tab-button" data-tab="cash-journal">Cash Journal</button>
            </div>

            <div class="tab-content" id="tab-deleted">
                <section class="deleted-proformas-section">
                    <div class="section-header">
                        <h2>üßæ –£–¥–∞–ª—ë–Ω–Ω—ã–µ –ø—Ä–æ—Ñ–æ—Ä–º—ã</h2>
                        <div class="controls">
                            <button id="refresh-deleted" class="btn btn-primary">üîÑ –û–±–Ω–æ–≤–∏—Ç—å</button>
                            <button id="export-deleted" class="btn btn-secondary" disabled>‚¨áÔ∏è –≠–∫—Å–ø–æ—Ä—Ç CSV</button>
                        </div>
                    </div>

                    <div class="filters-grid deleted-filters">
                        <div class="filter-field">
                            <label for="deleted-date-from">–î–∞—Ç–∞ —É–¥–∞–ª–µ–Ω–∏—è —Å</label>
                            <input type="date" id="deleted-date-from">
                        </div>
                        <div class="filter-field">
                            <label for="deleted-date-to">–î–∞—Ç–∞ —É–¥–∞–ª–µ–Ω–∏—è –ø–æ</label>
                            <input type="date" id="deleted-date-to">
                        </div>
                        <div class="filter-field">
                            <label for="deleted-status">–°—Ç–∞—Ç—É—Å</label>
                            <select id="deleted-status">
                                <option value="all">–í—Å–µ</option>
                                <option value="deleted" selected>–£–¥–∞–ª–µ–Ω–æ</option>
                            </select>
                        </div>
                        <div class="filter-field">
                            <label for="deleted-search">–ü–æ–∏—Å–∫ (–Ω–æ–º–µ—Ä, –ø–æ–∫—É–ø–∞—Ç–µ–ª—å, deal id)</label>
                            <input type="text" id="deleted-search" placeholder="CO-PROF..., –∏–º—è, email –∏–ª–∏ deal id">
                        </div>
                    </div>

                    <section class="table-section deleted-table-section">
                        <div class="section-header">
                            <h3>üìã –°–ø–∏—Å–æ–∫ —É–¥–∞–ª—ë–Ω–Ω—ã—Ö –ø—Ä–æ—Ñ–æ—Ä–º</h3>
                            <span id="deleted-count" class="section-subtitle">0 –∑–∞–ø–∏—Å–µ–π</span>
                        </div>
                        <div id="deleted-table" class="table-wrapper">
                            <div class="placeholder">–î–∞–Ω–Ω—ã–µ –µ—â—ë –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã</div>
                        </div>
                    </section>

                    <section class="logs-section deleted-logs">
                        <div class="section-header">
                            <h3>üìù –õ–æ–≥–∏ –∑–∞–≥—Ä—É–∑–∫–∏</h3>
                            <button id="deleted-clear-log" class="btn btn-link">–û—á–∏—Å—Ç–∏—Ç—å</button>
                        </div>
                        <div id="deleted-log" class="logs-container">
                            <div class="log-entry info">–ì–æ—Ç–æ–≤ –∫ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö</div>
                        </div>
                    </section>
                </section>
            </div>

            <div class="tab-content active" id="tab-report2">
                <section class="vat-margin-section">
                    <div class="section-header">
                        <h2>üí≥ –û—Ç—á—ë—Ç –ø–æ –ø–ª–∞—Ç–µ–∂–∞–º</h2>
                        <div class="controls">
                            <div class="month-year-select">
                                <label for="month-select">–ú–µ—Å—è—Ü</label>
                                <select id="month-select">
                                    <option value="1">–Ø–Ω–≤–∞—Ä—å</option>
                                    <option value="2">–§–µ–≤—Ä–∞–ª—å</option>
                                    <option value="3">–ú–∞—Ä—Ç</option>
                                    <option value="4">–ê–ø—Ä–µ–ª—å</option>
                                    <option value="5">–ú–∞–π</option>
                                    <option value="6">–ò—é–Ω—å</option>
                                    <option value="7">–ò—é–ª—å</option>
                                    <option value="8">–ê–≤–≥—É—Å—Ç</option>
                                    <option value="9">–°–µ–Ω—Ç—è–±—Ä—å</option>
                                    <option value="10">–û–∫—Ç—è–±—Ä—å</option>
                                    <option value="11">–ù–æ—è–±—Ä—å</option>
                                    <option value="12">–î–µ–∫–∞–±—Ä—å</option>
                                </select>
                            </div>
                            <div class="month-year-select">
                                <label for="year-select">–ì–æ–¥</label>
                                <select id="year-select">
                                    <option value="2025">2025</option>
                                    <option value="2026">2026</option>
                                    <option value="2027">2027</option>
                                    <option value="2028">2028</option>
                                    <option value="2029">2029</option>
                                    <option value="2030">2030</option>
                                </select>
                            </div>
                            <button id="export-payment-report" class="btn btn-secondary">‚¨áÔ∏è –≠–∫—Å–ø–æ—Ä—Ç CSV</button>
                        </div>
                    </div>

                    <div id="payment-report-summary" class="product-summary-cards"></div>
                    <div id="payment-report-container" class="vat-margin-container">
                        <div class="placeholder">–í—ã–±–µ—Ä–∏—Ç–µ –ø–µ—Ä–∏–æ–¥ –∏ –Ω–∞–∂–º–∏—Ç–µ ¬´–û–±–Ω–æ–≤–∏—Ç—å¬ª, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –ø–ª–∞—Ç–µ–∂–∏</div>
                    </div>
                </section>
            </div>

            <div class="tab-content" id="tab-stripe">
                <section class="vat-margin-section">
                    <div class="section-header">
                        <div class="section-title">
                            <h2>üéü –û—Ç—á—ë—Ç –ø–æ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è–º</h2>
                            <p class="section-subtitle">–ê–≥—Ä–µ–≥–∏—Ä—É–µ–º —É—Å–ø–µ—à–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è</p>
                        </div>
                        <div class="controls">
                            <span id="stripe-status-indicator" class="status-pill status-idle">–ü—Ä–æ–≤–µ—Ä–∫–∞...</span>
                        </div>
                    </div>

                    <div class="table-controls">
                        <span id="stripe-events-count" class="section-subtitle">0 –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π</span>
                    </div>

                    <div id="stripe-summary-totals" class="stripe-summary-totals"></div>
                    <div class="table-wrapper" id="stripe-summary-table"></div>
                </section>
            </div>

            <div class="tab-content" id="tab-products" data-tab-anchor="products">
                <section class="product-report-section">
                    <div class="section-header">
                        <div class="section-title">
                            <h2>üõç –û—Ç—á—ë—Ç –ø–æ –ø—Ä–æ–¥—É–∫—Ç–∞–º</h2>
                            <p class="section-subtitle">–°–ª–µ–¥–∏–º –∑–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º —Ä–∞—Å—á—ë—Ç–æ–≤ –∏ –¥–∞—Ç–∞–º–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø–æ –∫–∞–∂–¥–æ–º—É –ø—Ä–æ–¥—É–∫—Ç—É</p>
                        </div>
                        <div class="controls">
                            <button id="refresh-products" class="btn btn-primary">üîÑ –û–±–Ω–æ–≤–∏—Ç—å</button>
                        </div>
                    </div>

                    <div id="product-summary-table" class="product-summary-table">
                        <div class="placeholder">–ù–∞–∂–º–∏—Ç–µ ¬´–û–±–Ω–æ–≤–∏—Ç—å¬ª, —á—Ç–æ–±—ã –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–¥—É–∫—Ç–æ–≤.</div>
                    </div>
                </section>
            </div>

            <div class="tab-content" id="tab-payments">
                <div class="payments-subnav">
                    <button class="subtab-button active" data-payments-tab="incoming">–í—Ö–æ–¥—è—â–∏–µ</button>
                    <button class="subtab-button" data-payments-tab="outgoing">–ò—Å—Ö–æ–¥—è—â–∏–µ</button>
                </div>
                <section class="payments-section payments-subtab-content active" id="payments-incoming">
                    <div class="section-header">
                        <h2>–í—Ö–æ–¥—è—â–∏–µ –ø–ª–∞—Ç–µ–∂–∏ –∏ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ</h2>
                        <div class="controls">
                            <label class="upload-btn">
                                <input type="file" id="bank-csv-input" accept=".csv" hidden>
                                üì§ –ó–∞–≥—Ä—É–∑–∏—Ç—å CSV
                            </label>
                            <button id="bulk-approve-matches" class="btn btn-success">‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∞–≤—Ç–æ-—Å–æ–≤–ø–∞–¥–µ–Ω–∏—è</button>
                            <button id="reset-matches" class="btn btn-danger">‚ùå –°–±—Ä–æ—Å–∏—Ç—å</button>
                            <button id="export-payments" class="btn btn-secondary">‚¨áÔ∏è –≠–∫—Å–ø–æ—Ä—Ç CSV</button>
                        </div>
                    </div>

                    <div class="payments-table-container" id="payments-table">
                        <div class="placeholder">–ü–æ–∫–∞ –Ω–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π</div>
                    </div>
                </section>
                <section class="payments-section payments-subtab-content" id="payments-outgoing">
                    <div class="section-header">
                        <h2>–ò—Å—Ö–æ–¥—è—â–∏–µ –ø–ª–∞—Ç–µ–∂–∏ (—Ä–∞—Å—Ö–æ–¥—ã)</h2>
                        <div class="controls">
                            <button id="outgoing-upload-btn" class="btn btn-primary">üì§ –ó–∞–≥—Ä—É–∑–∏—Ç—å CSV</button>
                            <button id="outgoing-refresh-btn" class="btn btn-secondary">üîÑ –û–±–Ω–æ–≤–∏—Ç—å</button>
                        </div>
                    </div>
                    <div class="outgoing-iframe-wrapper">
                        <iframe
                            id="outgoing-expenses-iframe"
                            src="expenses.html?embedded=1"
                            title="–ò—Å—Ö–æ–¥—è—â–∏–µ –ø–ª–∞—Ç–µ–∂–∏"
                            loading="lazy"></iframe>
                    </div>
                </section>
            </div>
            <div class="tab-content" id="tab-cash-journal">
                <section class="status-section">
                    <h2>–°–≤–æ–¥–∫–∞ –Ω–∞–ª–∏—á–Ω—ã—Ö</h2>
                    <div class="status-grid">
                        <div class="status-card">
                            <h3>–û–∂–∏–¥–∞–µ–º (PLN)</h3>
                            <div class="status-indicator" id="cashSummaryExpected">0.00 PLN</div>
                        </div>
                        <div class="status-card">
                            <h3>–ü–æ–ª—É—á–µ–Ω–æ (PLN)</h3>
                            <div class="status-indicator" id="cashSummaryReceived">0.00 PLN</div>
                        </div>
                        <div class="status-card">
                            <h3>–í –æ–∂–∏–¥–∞–Ω–∏–∏</h3>
                            <div class="status-indicator" id="cashSummaryPending">0.00 PLN</div>
                        </div>
                    </div>
                </section>

                <section class="controls-section filters-section">
                    <h2>–§–∏–ª—å—Ç—Ä—ã</h2>
                    <div class="filters-grid">
                        <div class="filter-field">
                            <label>–ü—Ä–æ–¥—É–∫—Ç</label>
                            <select id="cashFilterProduct">
                                <option value="">–í—Å–µ –ø—Ä–æ–¥—É–∫—Ç—ã</option>
                            </select>
                        </div>
                        <div class="filter-field">
                            <label>–°—Ç–∞—Ç—É—Å</label>
                            <select id="cashFilterStatus">
                                <option value="">–í—Å–µ</option>
                                <option value="pending">–û–∂–∏–¥–∞–µ—Ç—Å—è</option>
                                <option value="pending_confirmation">–ù–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–∏</option>
                                <option value="received">–ü–æ–ª—É—á–µ–Ω–æ</option>
                                <option value="refunded">–í–æ–∑–≤—Ä–∞—Ç</option>
                            </select>
                        </div>
                        <div class="filter-field filter-actions">
                            <label>&nbsp;</label>
                            <button id="cashFiltersApply" class="btn btn-primary">üîÑ –û–±–Ω–æ–≤–∏—Ç—å</button>
                        </div>
                    </div>
                </section>

                <section class="results-section">
                    <h2>–ñ—É—Ä–Ω–∞–ª –Ω–∞–ª–∏—á–Ω—ã—Ö</h2>
                    <div class="table-wrapper">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>–ö–ª–∏–µ–Ω—Ç</th>
                                    <th>–°—É–º–º–∞</th>
                                    <th>–î–∞—Ç–∞ –æ–∂–∏–¥–∞–Ω–∏—è</th>
                                    <th>–°—Ç–∞—Ç—É—Å</th>
                                    <th>–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ</th>
                                    <th class="actions-header">–î–µ–π—Å—Ç–≤–∏—è</th>
                                </tr>
                            </thead>
                            <tbody id="cashTableBody">
                                <tr><td colspan="6" class="text-muted">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</td></tr>
                            </tbody>
                        </table>
                    </div>
                </section>
            </div>
        </div>

        <div class="logs-section">
            <div class="section-header">
                <h2>üìù –õ–æ–≥–∏</h2>
                <button id="clear-logs" class="btn btn-link">–û—á–∏—Å—Ç–∏—Ç—å</button>
            </div>
            <div id="logs-container" class="logs-container">
                <div class="log-entry info">–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ</div>
            </div>
        </div>
    </div>

    <div id="payer-payments-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="payer-payments-title">–ü–ª–∞—Ç–µ–∂–∏ –ø–ª–∞—Ç–µ–ª—å—â–∏–∫–∞</h3>
                <button class="modal-close" id="payer-payments-close" aria-label="–ó–∞–∫—Ä—ã—Ç—å">&times;</button>
            </div>
            <div class="modal-body" id="payer-payments-body">
                <div class="loading-indicator">–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</div>
            </div>
        </div>
    </div>

    <script src="/vat-margin-script.js"></script>
</body>
</html>
