# UI Design: Facebook Ads Expenses Management

## Обзор подвкладки

**Размещение:** В разделе "Отчеты" → вкладка "Платежи" → подвкладка "📊 Facebook Ads"  
**Название:** "📊 Facebook Ads"  
**Назначение:** Импорт CSV отчетов Facebook Ads и управление маппингом кампаний на продукты

---

## Структура подвкладки

### Контекст навигации

```
┌─────────────────────────────────────────────────────────────┐
│ [Отчеты] [PNL Отчет] [Marketing] [Настройки]               │ ← Главное меню
├─────────────────────────────────────────────────────────────┤
│ [Отчёт по месяцам] [Продукты] [Платежи] [Мероприятия] ... │ ← Вкладки
├─────────────────────────────────────────────────────────────┤
│ [Входящие] [Исходящие] [🔍 Диагностика] [📊 Facebook Ads] │ ← Подвкладки
└─────────────────────────────────────────────────────────────┘
```

### Заголовок секции

```
┌─────────────────────────────────────────────────────────────┐
│ 📊 Facebook Ads - Управление расходами на рекламу          │
│ Импорт CSV отчетов и сопоставление кампаний с продуктами   │
└─────────────────────────────────────────────────────────────┘
```

### Внутренние вкладки

```
┌─────────────────────────────────────────────────────────────┐
│ [Импорт CSV] [Маппинг кампаний] [Статистика]               │ ← Внутренние вкладки
└─────────────────────────────────────────────────────────────┘
```

---

## Вкладка 1: Импорт CSV

### Секция загрузки файла

```
┌─────────────────────────────────────────────────────────────┐
│ 📤 Импорт CSV отчета Facebook Ads                           │
├─────────────────────────────────────────────────────────────┤
│                                                               │
│  ┌─────────────────────────────────────────────────────┐   │
│  │                                                     │   │
│  │     📁 Перетащите CSV файл сюда                    │   │
│  │     или нажмите для выбора файла                   │   │
│  │                                                     │   │
│  │     [Выбрать файл]                                 │   │
│  │                                                     │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                               │
│  Поддерживаемый формат: CSV с колонками:                    │
│  "Название кампании", Валюта, "Сумма затрат (PLN)",        │
│  "Дата начала отчетности", "Дата окончания отчетности"      │
│                                                               │
│  [🔄 Импортировать] (неактивна до выбора файла)            │
└─────────────────────────────────────────────────────────────┘
```

**Состояния:**
- **Пусто:** Показывается зона drag & drop
- **Файл выбран:** Показывается имя файла и кнопка "Импортировать" активна
- **Импорт в процессе:** Прогресс-бар и кнопка "Импортировать" неактивна
- **Импорт завершен:** Результаты импорта

### Секция результатов импорта

```
┌─────────────────────────────────────────────────────────────┐
│ ✅ Импорт завершен успешно                                   │
├─────────────────────────────────────────────────────────────┤
│                                                               │
│  📊 Статистика импорта:                                      │
│  • Всего строк обработано: 45                               │
│  • Размеченных кампаний: 38                                  │
│  • Неразмеченных кампаний: 7                                 │
│  • Обновлено записей: 12                                     │
│  • Создано новых записей: 33                                 │
│                                                               │
│  ⚠️ Неразмеченные кампании (требуют маппинга):              │
│  • "Camp / New Product" - 1500.50 PLN                       │
│  • "Event / Summer 2026" - 800.25 PLN                        │
│  • ... (5 еще)                                               │
│                                                               │
│  [Перейти к маппингу]                                        │
└─────────────────────────────────────────────────────────────┘
```

**Состояния ошибок:**
```
┌─────────────────────────────────────────────────────────────┐
│ ❌ Ошибка импорта                                             │
├─────────────────────────────────────────────────────────────┤
│                                                               │
│  Не удалось обработать файл:                                 │
│  • Строка 5: Некорректный формат даты                        │
│  • Строка 12: Отсутствует сумма затрат                       │
│  • Строка 23: Некорректное название кампании                 │
│                                                               │
│  [Повторить импорт]                                          │
└─────────────────────────────────────────────────────────────┘
```

### Секция истории импортов

```
┌─────────────────────────────────────────────────────────────┐
│ 📜 История импортов                                           │
├─────────────────────────────────────────────────────────────┤
│                                                               │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ Файл: facebook_ads_2025_01.csv                       │   │
│  │ Дата: 15.01.2025 14:30                               │   │
│  │ Обработано: 45 строк | Размечено: 38 | Ошибок: 0    │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                               │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ Файл: facebook_ads_2024_12.csv                       │   │
│  │ Дата: 15.12.2024 10:15                               │   │
│  │ Обработано: 42 строки | Размечено: 40 | Ошибок: 2   │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                               │
│  [Показать все]                                              │
└─────────────────────────────────────────────────────────────┘
```

---

## Вкладка 2: Маппинг кампаний

### Подвкладки или секции

```
┌─────────────────────────────────────────────────────────────┐
│ [Размеченные кампании] [Неразмеченные кампании]             │ ← Подвкладки
└─────────────────────────────────────────────────────────────┘
```

### Подвкладка: Размеченные кампании

```
┌─────────────────────────────────────────────────────────────┐
│ ✅ Размеченные кампании (38)                                 │
├─────────────────────────────────────────────────────────────┤
│                                                               │
│  🔍 [Поиск по названию кампании или продукту...]            │
│                                                               │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ Название кампании    │ Продукт      │ Расходы      │   │
│  ├─────────────────────────────────────────────────────┤   │
│  │ Camp / NY2026        │ NY2026       │ 3,189.86 PLN │   │
│  │                      │              │ [✏️] [🗑️]    │   │
│  ├─────────────────────────────────────────────────────┤   │
│  │ Event / NY2026       │ NY2026       │ 1,149.78 PLN │   │
│  │                      │              │ [✏️] [🗑️]    │   │
│  ├─────────────────────────────────────────────────────┤   │
│  │ Camp / Spain singles │ Spain singles│ 4,039.36 PLN│   │
│  │                      │              │ [✏️] [🗑️]    │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                               │
│  Показано: 10 из 38                                          │
│  [Показать все] [Экспорт в CSV]                              │
└─────────────────────────────────────────────────────────────┘
```

**Действия:**
- **✏️ Редактировать:** Открывает модальное окно для изменения продукта
- **🗑️ Удалить:** Удаляет маппинг (с подтверждением)

### Модальное окно редактирования маппинга

```
┌─────────────────────────────────────────────────────────────┐
│ ✏️ Редактировать маппинг                                     │
├─────────────────────────────────────────────────────────────┤
│                                                               │
│  Название кампании:                                          │
│  Camp / NY2026                                               │
│                                                               │
│  Продукт:                                                    │
│  [▼ Выберите продукт...]                                    │
│  • NY2026                                                    │
│  • Spain singles                                             │
│  • ...                                                       │
│                                                               │
│  [Отмена] [Сохранить]                                        │
└─────────────────────────────────────────────────────────────┘
```

### Подвкладка: Неразмеченные кампании

```
┌─────────────────────────────────────────────────────────────┐
│ ⚠️ Неразмеченные кампании (7)                                │
├─────────────────────────────────────────────────────────────┤
│                                                               │
│  🔍 [Поиск по названию кампании...]                          │
│                                                               │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ Название кампании    │ Расходы      │ Действие     │   │
│  ├─────────────────────────────────────────────────────┤   │
│  │ Camp / New Product   │ 1,500.50 PLN │ [➕ Создать] │   │
│  ├─────────────────────────────────────────────────────┤   │
│  │ Event / Summer 2026  │ 800.25 PLN  │ [➕ Создать] │   │
│  ├─────────────────────────────────────────────────────┤   │
│  │ coliving-bali-new    │ 2,300.00 PLN│ [➕ Создать] │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                               │
│  Показано: 7 из 7                                            │
│  [Создать маппинг для всех] (массовое действие)             │
└─────────────────────────────────────────────────────────────┘
```

**Действие "➕ Создать":**
- Открывает модальное окно для создания маппинга
- Показывает предложения продуктов на основе нормализованного названия

### Модальное окно создания маппинга

```
┌─────────────────────────────────────────────────────────────┐
│ ➕ Создать маппинг                                            │
├─────────────────────────────────────────────────────────────┤
│                                                               │
│  Название кампании:                                          │
│  Camp / New Product                                          │
│                                                               │
│  Предложенные продукты (на основе названия):                │
│  ○ New Product (ID: 123)                                     │
│  ○ New Product 2026 (ID: 124)                               │
│                                                               │
│  Или выберите другой продукт:                                │
│  [▼ Выберите продукт...]                                    │
│  • NY2026                                                    │
│  • Spain singles                                             │
│  • ...                                                       │
│                                                               │
│  [Отмена] [Создать маппинг]                                  │
└─────────────────────────────────────────────────────────────┘
```

---

## Вкладка 3: Статистика

### Общая статистика

```
┌─────────────────────────────────────────────────────────────┐
│ 📊 Статистика расходов на рекламу                            │
├─────────────────────────────────────────────────────────────┤
│                                                               │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐      │
│  │ Всего        │  │ Размечено    │  │ Неразмечено  │      │
│  │ кампаний     │  │ кампаний     │  │ кампаний     │      │
│  │              │  │              │  │              │      │
│  │     45       │  │     38       │  │      7       │      │
│  │              │  │   (84.4%)    │  │   (15.6%)    │      │
│  └──────────────┘  └──────────────┘  └──────────────┘      │
│                                                               │
│  ┌──────────────┐  ┌──────────────┐                         │
│  │ Общая сумма  │  │ По продуктам │                         │
│  │ расходов     │  │              │                         │
│  │              │  │              │                         │
│  │ 65,572.98    │  │ [Показать]   │                         │
│  │ PLN          │  │              │                         │
│  └──────────────┘  └──────────────┘                         │
└─────────────────────────────────────────────────────────────┘
```

### Статистика по продуктам

```
┌─────────────────────────────────────────────────────────────┐
│ 📈 Расходы по продуктам                                       │
├─────────────────────────────────────────────────────────────┤
│                                                               │
│  🔍 [Поиск по продукту...]                                   │
│                                                               │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ Продукт          │ Кампаний │ Расходы      │ %      │   │
│  ├─────────────────────────────────────────────────────┤   │
│  │ NY2026           │ 2        │ 4,339.64 PLN│ 6.6%   │   │
│  ├─────────────────────────────────────────────────────┤   │
│  │ Spain singles    │ 1        │ 4,039.36 PLN│ 6.2%   │   │
│  ├─────────────────────────────────────────────────────┤   │
│  │ Coliving December│ 1        │ 3,686.72 PLN│ 5.6%   │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                               │
│  Показано: 10 из 38                                          │
│  [Показать все] [Экспорт в CSV]                              │
└─────────────────────────────────────────────────────────────┘
```

### График расходов (опционально)

```
┌─────────────────────────────────────────────────────────────┐
│ 📊 Динамика расходов по месяцам                              │
├─────────────────────────────────────────────────────────────┤
│                                                               │
│  [График: линия или столбцы]                                 │
│                                                               │
│  Янв  Фев  Мар  Апр  Май  Июн  Июл  Авг  Сен  Окт  Ноя  Дек │
│                                                               │
└─────────────────────────────────────────────────────────────┘
```

---

## Состояния и интерактивность

### Состояния загрузки

**Импорт в процессе:**
```
┌─────────────────────────────────────────────────────────────┐
│ ⏳ Импорт в процессе...                                       │
├─────────────────────────────────────────────────────────────┤
│                                                               │
│  [████████████░░░░░░░░] 60%                                  │
│                                                               │
│  Обработано: 27 из 45 строк                                  │
│                                                               │
└─────────────────────────────────────────────────────────────┘
```

**Загрузка данных:**
```
┌─────────────────────────────────────────────────────────────┐
│ ⏳ Загрузка данных...                                         │
└─────────────────────────────────────────────────────────────┘
```

### Уведомления

**Успех:**
- Зеленый баннер вверху страницы: "✅ Маппинг успешно создан"
- Исчезает через 3 секунды

**Ошибка:**
- Красный баннер вверху страницы: "❌ Ошибка: [описание]"
- Кнопка "Закрыть" для ручного закрытия

**Предупреждение:**
- Желтый баннер: "⚠️ Внимание: [сообщение]"

### Подтверждения

**Удаление маппинга:**
```
┌─────────────────────────────────────────────────────────────┐
│ ⚠️ Подтверждение удаления                                    │
├─────────────────────────────────────────────────────────────┤
│                                                               │
│  Вы уверены, что хотите удалить маппинг?                    │
│                                                               │
│  Кампания: Camp / NY2026                                     │
│  Продукт: NY2026                                             │
│                                                               │
│  Расходы по этой кампании останутся в системе,              │
│  но перестанут быть связаны с продуктом.                     │
│                                                               │
│  [Отмена] [Удалить]                                          │
└─────────────────────────────────────────────────────────────┘
```

---

## Адаптивность

### Мобильная версия

- Вкладки превращаются в выпадающий список
- Таблицы становятся карточками
- Модальные окна занимают весь экран
- Упрощенная навигация

### Планшетная версия

- Компактные таблицы с горизонтальной прокруткой
- Вкладки остаются видимыми
- Модальные окна по центру экрана

---

## Цветовая схема

- **Основной цвет:** Синий (#007bff) - для кнопок действий
- **Успех:** Зеленый (#28a745) - для успешных операций
- **Ошибка:** Красный (#dc3545) - для ошибок
- **Предупреждение:** Желтый (#ffc107) - для предупреждений
- **Информация:** Голубой (#17a2b8) - для информационных сообщений

---

## Клавиатурные сокращения

- `Ctrl/Cmd + F` - фокус на поле поиска
- `Esc` - закрыть модальное окно
- `Enter` - подтвердить действие в модальном окне

---

## Валидация

### При импорте CSV:
- Проверка формата файла (должен быть CSV)
- Проверка наличия обязательных колонок
- Проверка формата дат (YYYY-MM-DD)
- Проверка сумм (должны быть положительными числами)

### При создании маппинга:
- Проверка выбора продукта (обязательно)
- Проверка уникальности маппинга (одна кампания - один продукт)

---

## Интеграция с другими страницами

### Ссылка из отчета по продуктам

В `vat-margin-product.html` в разделе "Связанные платежи":
```
┌─────────────────────────────────────────────────────────────┐
│ Связанные платежи                                            │
├─────────────────────────────────────────────────────────────┤
│                                                               │
│  [📊 Управление рекламными расходами]                        │
│                                                               │
│  ... (список платежей)                                       │
└─────────────────────────────────────────────────────────────┘
```

Ссылка ведет на `/facebook-ads-mappings.html?product=123` (с фильтром по продукту)

